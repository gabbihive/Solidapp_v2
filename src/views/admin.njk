{% extends "layout.njk" %}
{% block content %}
<h2>Admin</h2>

<section class="card">
  <h3>Sections</h3>
  <form method="post" action="/{{ ADMIN_SLUG }}/sections" class="grid2">
    <input name="slug" placeholder="slug" required>
    <input name="name" placeholder="name" required>
    <input name="description" placeholder="description">
    <label><input type="checkbox" name="is_active" value="1" checked> active</label>
    <button type="submit">Save</button>
  </form>
  <ul class="list">
    {% for s in sections %}
      <li>
        <strong>{{ s.slug }}</strong> â€” {{ s.name }}
        {% if s.is_active %}<span class="muted">(active)</span>{% else %}<span class="muted">(disabled)</span>{% endif %}
      </li>
    {% else %}
      <li class="muted">No sections yet.</li>
    {% endfor %}
  </ul>
</section>

<section class="card">
  <h3>Tags</h3>
  <form method="post" action="/{{ ADMIN_SLUG }}/tags" class="grid2">
    <input name="slug" placeholder="slug" required>
    <input name="name" placeholder="name" required>
    <input name="color" placeholder="#4fa3ff" value="#4fa3ff">
    <button type="submit">Save</button>
  </form>
  <ul class="list">
    {% for t in tags %}
      <li>
        <span class="tag" style="--c: {{ t.color }}">{{ t.name }}</span>
        <span class="muted">({{ t.slug }})</span>
      </li>
    {% else %}
      <li class="muted">No tags yet.</li>
    {% endfor %}
  </ul>
</section>

<section class="card">
  <h3>Recent posts</h3>
  <table class="table">
    <thead>
      <tr>
        <th>ID</th><th>Section</th><th>Title</th><th>Score</th><th>Status</th><th>Sticky</th><th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for p in posts %}
        <tr>
          <td>{{ p.id }}</td>
          <td>{{ p.section_slug }}</td>
          <td>{{ p.title }}</td>
          <td>{{ p.score }}</td>
          <td>{{ p.status }}</td>
          <td>
            {% if p.is_sticky %}yes{% else %}no{% endif %}
          </td>
          <td class="nowrap">
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/hide" class="inline"><button>hide</button></form>
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/show" class="inline"><button>show</button></form>
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/freeze" class="inline"><button>freeze</button></form>
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/delete" class="inline"><button>delete</button></form>
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/pin" class="inline"><button>pin</button></form>
            <form method="post" action="/{{ ADMIN_SLUG }}/post/{{ p.id }}/unpin" class="inline"><button>unpin</button></form>
          </td>
        </tr>
      {% else %}
        <tr><td colspan="7" class="muted">No posts yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}